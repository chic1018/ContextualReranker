# 智能终端设备卡片动态重排算法

**场景现状：**

* **交互限制：** m*n 网格布局，用户仅能通过“上下左右”四向键操控。
* **效率瓶颈：** 随着绑定设备增加，寻找特定设备的**路径长度 (Path Length)** 显著增加。
* **体验断层：** 静态列表无法响应用户在不同时间、不同环境下的动态需求。

**核心目标：**

* **缩短路径：** 将用户“当下最想用”的设备推送到 Grid 的前 Top-3 位置。
* **智能感知：** 从“人找设备”转变为“设备找人”。

## 评分模型

我们构建了一个多维度的评分公式，以平衡长期习惯与即时需求：

$$Score_{total} = W_p \cdot Score_{period} + W_e \cdot Score_{env} + W_r \cdot Score_{recency}$$

**三大支柱：**

1. $Score_{period}$ **(周期习惯)：** 基于历史数据的长时记忆（Long-term Memory）。
2. $Score_{env}$ **(环境感知)：** 基于传感器阈值的自适应触发（Context Awareness）。
3. $Score_{recency}$ **(短期交互)：** 基于最近操作的短期记忆（Short-term Memory）。



# 周期性习惯 ($Score_{period}$)

## 捕捉用户的作息规律

**实现方案：滑动窗口统计 (Sliding Window Statistics)** 采用高精度的环形统计方案。

* **数据结构：** `History_Matrix[Device][Time_Slot][Last_N_Days]`
* **时间分桶 (Time Slot)：** 将全天划分为 4-6 个生活时段（如：起床、离家、归家、睡眠）。
* **统计窗口：** 追踪最近 **7-14 天** 的点击行为。
* **算法逻辑：**
  * 每日滚动更新，自动剔除过期数据。
  * 依据当前系统时间，$Score_{period}$ 等于该时段过去 N 天的点击总和。

**优势：** 相比简单的衰减算法，能更精准地刻画“周一到周五”与“周末”的差异化习惯。



# 环境自适应 ($Score_{env}$)

## 响应环境变化的“突发需求”

**实现方案：自适应阈值触发 (Adaptive Thresholding)** 不依赖复杂的连续函数，采用高效的**阶梯响应模型**。

* **初始预设：** 基于设备类型 (Category) 加载默认敏感度。
  * *温控类*：响应温度 (18°C / 28°C)。
  * *照明类*：响应光照 (< 30 Lux)。
* **自适应微调 (核心创新)：**
  * **正反馈：** 用户在阈值触发前主动操作 -> **降低**阈值（更灵敏）。
  * **负反馈：** 阈值触发后用户无操作 -> **提高**阈值（防打扰）。
* **得分逻辑：**
  * 舒适区内得分 = 0。
  * 突破阈值时，偏离度越大，得分越高，赋予“击穿”周期的优先级。



# 短期交互 ($Score_{recency}$)

## 优化连续操作体验

**实现方案：带时间衰减的粘性分** 解决“刚操作完误触退出”或“需要连续调节”的场景。

* **触发机制：** 用户点击设备 -> 该设备 $Score_{recency}$ 拉满 (Max)。
* **衰减策略：**
  * 采用**指数移动平均 (EMA)** 思想进行异步衰减。
  * 每分钟或每次全局交互后，分值右移/按比例缩小。
* **UX 价值：** 保证当前正在高频互动的设备，在短时间内“粘”在列表头部，不会因为环境或时间变化突然跳走。



# 边界处理

**冷启动策略：**

* 新设备赋予 24 小时“新手保护分”，防止沉底。
* 无历史数据时，退化为基于设备类型的默认环境响应模型。